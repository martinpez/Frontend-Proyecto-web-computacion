---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import GitLogo from "../../components/GitLogo.astro";
import ButtonDowload from "../../components/ButtonDowload.astro";
import Back from "../../components/Back.astro";
import { file } from "astro/loaders";
const apps = await getCollection("apps");

export async function getStaticPaths() {
    const apps = await getCollection("apps");
    return apps.map((app) => ({
        params: { id: app.slug },
        props: { app },
    }));
}

export const prerender = true;

const { app } = Astro.props;
const { data, slug } = app;
const { title, developer, img, repo, name_repo, languages, carpetaBucket ,filename } = data;
const { Content } = await render(app);

---

<Layout title={`${title} - Dev Apps`}>
    <div class="flex p-8 gap-8">
        <aside class="flex flex-col items-center gap-3">
            <a href="/" class="hover:underline opacity-100">
                <Back />
            </a>
            <img
                transition:name={`img-${slug}`}
                class="rounded w-72 h-auto shadow-xl"
                src={`/${img}`}
                alt={title}
            />

                <ButtonDowload/ server:defer carpetaBucket={carpetaBucket} filename={filename} />
           
        </aside>

        

        <main class="max-w-3xl pt-14">
            <h1
                transition:name={`title-${slug}`}
                class="text-4xl font-bold mb-4"
            >
                {title}
            </h1>
            <div class="prose prose-invert">
                <Content />
                <div class="text-xg pt-8">
                    <p
                        transition:name={`lenguajes-${slug}`}
                        class="font-bold text-lg"
                    >
                        ðŸ“– Lenguajes usados:
                    </p>
                    <ul class="list-disc ml-4 ps-7">
                        {languages.map((lang) => <li>{lang}</li>)}
                    </ul>
                </div>
                <div class="text-xg pt-3">
                    <a
                        href={repo}
                        target="_blank"
                        class="flex items-center gap-2 mt-2"
                    >
                        <GitLogo name_repo={name_repo} />
                        <span class="text-xg">{developer}</span>
                    </a>
                </div>
            </div>
        </main>
    </div>
</Layout>